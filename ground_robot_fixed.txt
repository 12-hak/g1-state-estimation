    def _ground_robot(self):
        """Adjust base height so feet stay on the ground."""
        # Set initial height
        self.data.qpos[2] = 2.0
        mujoco.mj_forward(self.model, self.data)

        lowest_z = None
        
        # Try foot sites first
        left_foot_id = mujoco.mj_name2id(self.model, mujoco.mjtObj.mjOBJ_SITE, "left_foot")
        right_foot_id = mujoco.mj_name2id(self.model, mujoco.mjtObj.mjOBJ_SITE, "right_foot")
        
        if left_foot_id >= 0 and right_foot_id >= 0:
            left_z = self.data.site_xpos[left_foot_id, 2]
            right_z = self.data.site_xpos[right_foot_id, 2]
            lowest_z = min(left_z, right_z) - 0.025
        else:
            # Scan all bodies to find feet/ankles
            if not hasattr(self, '_foot_body_ids'):
                # One-time scan to find foot bodies
                print("[Ground] Scanning for foot/ankle bodies...")
                self._foot_body_ids = []
                for i in range(self.model.nbody):
                    name = mujoco.mj_id2name(self.model, mujoco.mjtObj.mjOBJ_BODY, i)
                    if name:
                        name_lower = name.lower()
                        if 'ankle' in name_lower or 'foot' in name_lower or 'toe' in name_lower:
                            self._foot_body_ids.append(i)
                            print(f"  Found body: {name} (id={i})")
                
                if not self._foot_body_ids:
                    print("[Ground] No foot bodies found, using default height")
            
            # Use found foot bodies
            if self._foot_body_ids:
                for body_id in self._foot_body_ids:
                    z = self.data.xpos[body_id, 2]
                    if lowest_z is None or z < lowest_z:
                        lowest_z = z
                
                if lowest_z is not None:
                    lowest_z -= 0.05  # Offset for foot thickness
        
        # Apply grounding
        if lowest_z is not None:
            self.data.qpos[2] -= lowest_z
        else:
            self.data.qpos[2] = 0.793
